<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Job Search</title>
    <script>
        function displaySkills(select) {
            const userId = select.value;
            const url = `./fetch_skills/${userId}/`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const skillsDiv = document.getElementById('skills');
                    skillsDiv.innerHTML = "<h2>Associated Skills:</h2>";

                    data.skills.forEach(skill => {
                        skillsDiv.innerHTML += `
                            <label>
                                <input type="checkbox" name="selected_skills" value="${skill}">
                                ${skill}
                            </label><br>
                        `;
                    });
                })
                .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
    <h1>Job Search</h1>

    <form action="{% url 'confirm_job_search' %}" method="post">
        {% csrf_token %}
        <label for="user_id">Select User:</label>
        <select name="user_id" id="user_id" onchange="displaySkills(this)">
            <option value="">Select a user</option>
            {% for user in users %}
                <option value="{{ user.id }}">{{ user.first_name }} {{ user.last_name }}</option>
            {% endfor %}
        </select>

        <div id="skills"></div>

        <button type="submit">Search Jobs</button>
    </form>
</body>
</html>
